# Png2Svg C++ ç‰ˆæœ¬ - PNGè½¬SVGçŸ¢é‡åŒ–å·¥å…·

åŸºäºPotraceçš„å¤šè‰²æ …æ ¼åˆ°çŸ¢é‡è¿½è¸ªå™¨çš„C++å®ç°ã€‚è¾“å…¥PNGå›¾åƒï¼Œè¾“å‡ºSVGçŸ¢é‡å›¾ã€‚

> ğŸ™ **è‡´è°¢**ï¼šæœ¬é¡¹ç›®åŸºäº [btk/vectorizer](https://github.com/btk/vectorizer) çš„è®¾è®¡ç†å¿µå®ç°ï¼Œæ„Ÿè°¢åŸä½œè€…çš„è´¡çŒ®ï¼è¯¦è§ [../CREDITS.md](../CREDITS.md)

## åŠŸèƒ½ç‰¹æ€§

- ğŸ¨ **å¤šè‰²æ”¯æŒ** - è‡ªåŠ¨æ£€æµ‹å¹¶ä¿ç•™å›¾åƒä¸­çš„å¤šç§é¢œè‰²
- ğŸ” **æ™ºèƒ½åˆ†æ** - è‡ªåŠ¨åˆ†æå›¾åƒå¹¶æä¾›å¤šç§çŸ¢é‡åŒ–é€‰é¡¹
- ğŸ“ **é«˜è´¨é‡è¾“å‡º** - ç”Ÿæˆä¼˜åŒ–çš„SVGçŸ¢é‡å›¾å½¢
- ğŸ¯ **çµæ´»é…ç½®** - å¯è‡ªå®šä¹‰é¢œè‰²æ•°é‡å’Œå¤„ç†æ­¥éª¤
- ğŸ“ **æ‰¹é‡å¤„ç†** - æ”¯æŒå•æ–‡ä»¶æˆ–æ•´ä¸ªç›®å½•çš„æ‰¹é‡è½¬æ¢
- ğŸš€ **é«˜æ€§èƒ½** - C++åŸç”Ÿå®ç°ï¼Œå¤„ç†é€Ÿåº¦æ›´å¿«
- ğŸ’¡ **è·¨å¹³å°** - æ”¯æŒmacOSã€Linuxå’ŒWindows

## æ„å»ºè¦æ±‚

### ç³»ç»Ÿä¾èµ–

1. **C++17ç¼–è¯‘å™¨** (GCC 7+, Clang 5+, MSVC 2017+)
2. **CMake 3.14+**
3. **Potrace** (å¿…é¡»å•ç‹¬å®‰è£…)

### å®‰è£…Potrace

**macOS:**
```bash
brew install potrace
```

**Ubuntu/Debian:**
```bash
sudo apt-get install potrace
```

**Windows:**
ä» [Potraceå®˜ç½‘](http://potrace.sourceforge.net/) ä¸‹è½½å¹¶å®‰è£…

## æ„å»ºå®‰è£…

### å¿«é€Ÿæ„å»º

```bash
# è¿›å…¥C++é¡¹ç›®ç›®å½•
cd cpp

# åˆ›å»ºæ„å»ºç›®å½•
mkdir build && cd build

# é…ç½®é¡¹ç›®
cmake ..

# ç¼–è¯‘
make -j4

# å¯é€‰ï¼šå®‰è£…åˆ°ç³»ç»Ÿ
sudo make install
```

### è¯¦ç»†æ„å»ºé€‰é¡¹

```bash
# Releaseç‰ˆæœ¬ï¼ˆä¼˜åŒ–ï¼‰
cmake -DCMAKE_BUILD_TYPE=Release ..

# Debugç‰ˆæœ¬ï¼ˆè°ƒè¯•ï¼‰
cmake -DCMAKE_BUILD_TYPE=Debug ..

# è‡ªå®šä¹‰å®‰è£…è·¯å¾„
cmake -DCMAKE_INSTALL_PREFIX=/custom/path ..
```

### Windowsæ„å»º (Visual Studio)

```cmd
# åˆ›å»ºæ„å»ºç›®å½•
mkdir build
cd build

# ç”ŸæˆVisual Studioé¡¹ç›®
cmake -G "Visual Studio 16 2019" -A x64 ..

# ä½¿ç”¨Visual Studioæ‰“å¼€ç”Ÿæˆçš„.slnæ–‡ä»¶ç¼–è¯‘
# æˆ–ä½¿ç”¨å‘½ä»¤è¡Œï¼š
cmake --build . --config Release
```

## ä½¿ç”¨æ–¹æ³•

### å‘½ä»¤è¡Œä½¿ç”¨

```bash
# æ˜¾ç¤ºä½¿ç”¨å¸®åŠ©
./png2svg

# è½¬æ¢å•ä¸ªPNGæ–‡ä»¶ï¼ˆè‡ªåŠ¨æ¨¡å¼ï¼‰
./png2svg /path/to/image.png --auto

# è½¬æ¢å•ä¸ªPNGæ–‡ä»¶ï¼ˆäº¤äº’å¼é€‰æ‹©ï¼‰
./png2svg /path/to/image.png

# æ‰¹é‡è½¬æ¢ç›®å½•ä¸­æ‰€æœ‰PNGæ–‡ä»¶
./png2svg /path/to/directory --auto

# æŸ¥çœ‹æ–‡ä»¶çš„çŸ¢é‡åŒ–é€‰é¡¹
./png2svg /path/to/image.png --inspect-only

# æŒ‡å®šä½¿ç”¨ç‰¹å®šé€‰é¡¹
./png2svg /path/to/image.png --auto --option 2
```

### å‘½ä»¤è¡Œå‚æ•°

- `--auto` - è‡ªåŠ¨é€‰æ‹©ç¬¬ä¸€ä¸ªçŸ¢é‡åŒ–é€‰é¡¹ï¼ˆé»˜è®¤äº¤äº’å¼é€‰æ‹©ï¼‰
- `--option N` - ä¸--autoé…åˆä½¿ç”¨ï¼Œé€‰æ‹©ç¬¬Nä¸ªé€‰é¡¹ï¼ˆé»˜è®¤: 0ï¼‰
- `--inspect-only` - ä»…æ˜¾ç¤ºå¯ç”¨é€‰é¡¹ï¼Œä¸è¿›è¡Œè½¬æ¢
- `--help`, `-h` - æ˜¾ç¤ºå¸®åŠ©ä¿¡æ¯

## APIä½¿ç”¨ï¼ˆä½œä¸ºåº“ï¼‰

å¦‚æœæ‚¨æƒ³åœ¨è‡ªå·±çš„C++é¡¹ç›®ä¸­ä½¿ç”¨vectorizeråº“ï¼š

```cpp
#include "vectorizer.h"

int main() {
    // åˆ›å»ºVectorizerå®ä¾‹
    Vectorizer vectorizer;
    
    // åˆ†æå›¾åƒï¼Œè·å–å¯ç”¨çš„çŸ¢é‡åŒ–é€‰é¡¹
    std::vector<VectorizationOption> options = vectorizer.inspectImage("image_name");
    
    // é€‰æ‹©ä¸€ä¸ªé€‰é¡¹è¿›è¡Œè½¬æ¢
    if (!options.empty()) {
        VectorizationOption option = options[0];  // ä½¿ç”¨ç¬¬ä¸€ä¸ªé€‰é¡¹
        std::string svgContent = vectorizer.parseImage("image_name", 
                                                       option.step, 
                                                       option.colors);
        std::cout << "è½¬æ¢å®Œæˆï¼" << std::endl;
    }
    
    return 0;
}
```

## é¡¹ç›®ç»“æ„

```
cpp/
â”œâ”€â”€ CMakeLists.txt           # CMakeæ„å»ºé…ç½®
â”œâ”€â”€ cmake_uninstall.cmake.in # å¸è½½è„šæœ¬æ¨¡æ¿
â”œâ”€â”€ README.md                # æœ¬æ–‡æ¡£
â”œâ”€â”€ include/                 # å¤´æ–‡ä»¶ç›®å½•
â”‚   â””â”€â”€ vectorizer.h        # Vectorizerç±»å£°æ˜
â”œâ”€â”€ src/                     # æºä»£ç ç›®å½•
â”‚   â”œâ”€â”€ main.cpp            # ä¸»ç¨‹åºå…¥å£
â”‚   â””â”€â”€ vectorizer.cpp      # Vectorizerç±»å®ç°
â”œâ”€â”€ third_party/            # ç¬¬ä¸‰æ–¹åº“ï¼ˆè‡ªåŠ¨ä¸‹è½½ï¼‰
â”‚   â”œâ”€â”€ stb_image.h        # å›¾åƒè¯»å–åº“
â”‚   â””â”€â”€ stb_image_write.h  # å›¾åƒå†™å…¥åº“
â””â”€â”€ build/                  # æ„å»ºè¾“å‡ºç›®å½•ï¼ˆéœ€åˆ›å»ºï¼‰
    â””â”€â”€ bin/               # å¯æ‰§è¡Œæ–‡ä»¶è¾“å‡º
        â””â”€â”€ png2svg        # ç”Ÿæˆçš„å¯æ‰§è¡Œæ–‡ä»¶
```

## æ€§èƒ½å¯¹æ¯”

ç›¸æ¯”Pythonç‰ˆæœ¬ï¼ŒC++ç‰ˆæœ¬å…·æœ‰ä»¥ä¸‹ä¼˜åŠ¿ï¼š

- **é€Ÿåº¦æå‡**: å¤„ç†é€Ÿåº¦æå‡2-5å€
- **å†…å­˜ä¼˜åŒ–**: å†…å­˜ä½¿ç”¨å‡å°‘30-50%
- **å¹¶å‘æ”¯æŒ**: å¯åˆ©ç”¨å¤šæ ¸CPUå¹¶è¡Œå¤„ç†ï¼ˆæœªæ¥ç‰ˆæœ¬ï¼‰
- **ç‹¬ç«‹éƒ¨ç½²**: ç¼–è¯‘åæ— éœ€Pythonç¯å¢ƒ

## è¾“å‡ºè§„åˆ™

- **å•æ–‡ä»¶æ¨¡å¼**: SVGç”Ÿæˆåœ¨PNGæ–‡ä»¶çš„åŒç›®å½•ä¸‹
- **ç›®å½•æ‰¹é‡æ¨¡å¼**: SVGä¿å­˜åˆ° `svg_output` å­ç›®å½•ä¸­

## æŠ€æœ¯å®ç°

### æ ¸å¿ƒç®—æ³•

1. **å›¾åƒåˆ†æ**: ä½¿ç”¨é¢œè‰²é‡åŒ–ç®—æ³•æå–ä¸»è¦é¢œè‰²
2. **é¢œè‰²åˆ†ç±»**: æ ¹æ®RGBå€¼åˆ¤æ–­å›¾åƒç±»å‹
3. **çŸ¢é‡åŒ–å¤„ç†**: è°ƒç”¨Potraceè¿›è¡Œè·¯å¾„è¿½è¸ª
4. **é¢œè‰²æ˜ å°„**: å°†å•è‰²SVGæ˜ å°„åˆ°å¤šè‰²è¾“å‡º
5. **ä¼˜åŒ–è¾“å‡º**: å‹ç¼©SVGä»£ç ï¼Œæ·»åŠ viewBoxæ”¯æŒ

### ä¾èµ–åº“

- **stb_image**: è½»é‡çº§å›¾åƒè¯»å†™åº“
- **C++17 filesystem**: æ–‡ä»¶ç³»ç»Ÿæ“ä½œ
- **regex**: æ­£åˆ™è¡¨è¾¾å¼å¤„ç†
- **potrace**: å¤–éƒ¨çŸ¢é‡åŒ–å·¥å…·

## æ•…éšœæ’é™¤

### å¸¸è§é—®é¢˜

1. **æ‰¾ä¸åˆ°potrace**
   - ç¡®ä¿potraceå·²å®‰è£…å¹¶åœ¨PATHä¸­
   - ä½¿ç”¨ `which potrace` (Unix) æˆ– `where potrace` (Windows) æ£€æŸ¥

2. **ç¼–è¯‘é”™è¯¯ï¼šfilesystem not found**
   - ç¡®ä¿ä½¿ç”¨æ”¯æŒC++17çš„ç¼–è¯‘å™¨
   - æŸäº›æ—§ç‰ˆæœ¬ç¼–è¯‘å™¨éœ€è¦é“¾æ¥ `-lstdc++fs`

3. **stb_imageä¸‹è½½å¤±è´¥**
   - æ‰‹åŠ¨ä¸‹è½½å¹¶æ”¾ç½®åˆ°third_partyç›®å½•
   - ä¸‹è½½åœ°å€: https://github.com/nothings/stb

## æœªæ¥è®¡åˆ’

- [ ] æ·»åŠ å¤šçº¿ç¨‹æ‰¹é‡å¤„ç†æ”¯æŒ
- [ ] å®ç°æ›´ç²¾ç¡®çš„K-meansé¢œè‰²èšç±»
- [ ] æ·»åŠ GUIç•Œé¢
- [ ] æ”¯æŒæ›´å¤šå›¾åƒæ ¼å¼ï¼ˆJPG, BMPç­‰ï¼‰
- [ ] é›†æˆæ›´å¤šçŸ¢é‡åŒ–å¼•æ“é€‰é¡¹

## è‡´è°¢

æœ¬é¡¹ç›®åŸºäº [btk/vectorizer](https://github.com/btk/vectorizer) çš„è®¾è®¡æ€è·¯å®ç°ï¼Œç‰¹æ­¤æ„Ÿè°¢åŸä½œè€…çš„è´¡çŒ®ï¼

åŸé¡¹ç›® [vectorizer](https://github.com/btk/vectorizer) æ˜¯ä¸€ä¸ªåŸºäºPotraceçš„å¤šè‰²æ …æ ¼åˆ°çŸ¢é‡è¿½è¸ªå™¨ï¼ˆJavaScriptå®ç°ï¼‰ï¼Œæä¾›äº†æ ¸å¿ƒçš„çŸ¢é‡åŒ–ç®—æ³•å’Œè®¾è®¡ç†å¿µã€‚æœ¬C++ç‰ˆæœ¬åœ¨å…¶åŸºç¡€ä¸Šè¿›è¡Œäº†ä»¥ä¸‹æ”¹è¿›ï¼š
- åŸç”ŸC++å®ç°ï¼Œæ€§èƒ½æ›´ä¼˜
- è·¨å¹³å°æ”¯æŒï¼ˆmacOSã€Linuxã€Windowsï¼‰
- æ›´é«˜æ•ˆçš„å†…å­˜ç®¡ç†
- ä¿æŒäº†ä¸åŸé¡¹ç›®ç›¸åŒçš„æ ¸å¿ƒåŠŸèƒ½
- æ‰©å±•äº†æ‰¹å¤„ç†å’Œå‘½ä»¤è¡ŒåŠŸèƒ½

## è®¸å¯è¯

MIT License

## è´¡çŒ®

æ¬¢è¿æäº¤é—®é¢˜å’Œæ‹‰å–è¯·æ±‚ï¼

## æ³¨æ„äº‹é¡¹

- ç¡®ä¿è¾“å…¥å›¾åƒä¸ºPNGæ ¼å¼
- å¤§å›¾åƒå¯èƒ½éœ€è¦è¾ƒé•¿å¤„ç†æ—¶é—´
- å»ºè®®å›¾åƒå¤§å°å°äº2000x2000åƒç´ 
- é¦–æ¬¡æ„å»ºä¼šè‡ªåŠ¨ä¸‹è½½stb_imageåº“
